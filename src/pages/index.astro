---
import Layout from '../layouts/Layout.astro';
const whatsapp = import.meta.env.PUBLIC_WHATSAPP;
const products = [
  {
    name: 'Bacon Smash',
    image: '/images/burger1.jpg',
    description: 'Doble carne, cheddar, panceta crocante y salsa especial.',
  },
  {
    name: 'Clásica Doble',
    image: '/images/burger2.jpg',
    description: 'Pan casero, doble medallón, lechuga, tomate y cheddar.',
  },
  {
    name: 'Veggie Corner',
    image: '/images/burger3.jpg',
    description: 'Hamburguesa de lentejas con vegetales y alioli vegano.',
  },
];
---

<Layout title="BIG CORNER - Hamburguesas">
  <section class="menu">
    <h2>Menú</h2>
    <div class="burger-list">
      {products.map((product, index) => (
        <div class="burger-card" onclick={`openModal(${index})`}>
          <img src={product.image} alt={product.name} />
          <h3>{product.name}</h3>
          <p>{product.description}</p>
        </div>
      ))}
    </div>
  </section>

  <!-- Modal -->
  <div id="burger-modal" class="modal hidden">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modal-img" src="" alt="Hamburguesa" />
      <h3 id="modal-title"></h3>
      <p id="modal-description"></p>
      <form id="order-form" onsubmit="sendOrder(event)">
        <label for="quantity">Cantidad:</label>
        <input type="number" id="quantity" name="quantity" min="1" value="1" required />

        <label for="address">Dirección de entrega:</label>
        <input type="text" id="address" name="address" required />

        <label for="comment">Comentario adicional:</label>
        <textarea id="comment" name="comment"></textarea>

        <input type="hidden" id="product-name" name="product-name" />
        <button type="submit">Pedir por WhatsApp</button>
      </form>
    </div>
  </div>

  <script type="module">
    const products = [
      {
        name: 'Bacon Smash',
        image: '/images/burger1.jpg',
        description: 'Doble carne, cheddar, panceta crocante y salsa especial.'
      },
      {
        name: 'Clásica Doble',
        image: '/images/burger2.jpg',
        description: 'Pan casero, doble medallón, lechuga, tomate y cheddar.'
      },
      {
        name: 'Veggie Corner',
        image: '/images/burger3.jpg',
        description: 'Hamburguesa de lentejas con vegetales y alioli vegano.'
      }
    ];

    const whatsapp = import.meta.env.PUBLIC_WHATSAPP;

    window.openModal = function(index) {
      const modal = document.getElementById('burger-modal');
      const product = products[index];
      document.getElementById('modal-img').src = product.image;
      document.getElementById('modal-title').textContent = product.name;
      document.getElementById('modal-description').textContent = product.description;
      document.getElementById('product-name').value = product.name;
      modal.classList.remove('hidden');
    }

    window.closeModal = function() {
      document.getElementById('burger-modal').classList.add('hidden');
    }

    window.sendOrder = function(event) {
      event.preventDefault();
      const name = document.getElementById('product-name').value;
      const qty = document.getElementById('quantity').value;
      const address = document.getElementById('address').value;
      const comment = document.getElementById('comment').value;

      const text = encodeURIComponent(`Hola! Quiero pedir ${qty} ${name}\nDirección: ${address}\n${comment ? 'Comentario: ' + comment : ''}`);
      window.open(`https://wa.me/${whatsapp}?text=${text}`, '_blank');
      window.closeModal();
    }
  </script>
</Layout>
